package primus

import (
	"testing"
)

func TestTimestampParse(t *testing.T) {
	bs := mustDecode("4c010000571000018e2c795d84a60fe4e8c04cd2a0333a9e087433339925c2ef6a83affc9a4b1b46d7e448a4b6c8355becf728fed548f01931ff4f96d5695fc1a21aed03ad6f7e42fc6815f0243262a107bff2c3c64b8990f7ee52f5478e24bd9c2d8d6959a4c8cec28aeedca07cc041c1868b290815b18c0e8933512cbc18191294deafd8534cbb0d053065acd5826835febcba99c1c57b22f618f13901e7b5369498fe8e64ca2eec15468743b2754fb4bba35f40d37d5b9f7ac1fda90bcf6e921273a1b673eeabcb00581afdde5eeea9705e3a578b294824474482d92de44219d70a3bbf6bba1c4e12caa7406477c84078e56bcc703f1566a05e46dfe88f495a711fadf981944607010800f8ac10670000000002103500696e746567726974794b65794e616d652d31383866313637382d663466332d343730642d393831632d373436613230336566613537000000")
	signatureKeyName, seconds := DecodePrimusTimestamp(bs)

	if seconds != 1729146104 {
		panic("invalid parse timestamp")
	}
	if signatureKeyName != "integrityKeyName-188f1678-f4f3-470d-981c-746a203efa57" {
		panic("invalid parse signature key")
	}
}
